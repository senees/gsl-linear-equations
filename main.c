/*
 * MIT License
 *
 * Copyright (c) 2022 seenees
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

#include <assert.h>
#include <stdio.h>
#include <gsl/gsl_blas.h>
#include <gsl/gsl_linalg.h>
#include <gsl/gsl_permutation.h>

#define LENGTH(x)  (sizeof(x) / sizeof((x)[0]))

int main() {
  double X_data[] = {
    1, 0.25386327860172475, 0.06444656422241692, 0.9260273972602739, 0.23508435114351497, 1, 0.19446576706022412,
    0.037816934558321344, 0.9260273972602739, 0.18008062812700204, 1, 0.13828054105989113, 0.019121508035816234,
    0.9260273972602739, 0.12805156952943342, 1, 0.0849779064920866, 0.007221244591777814, 0.9260273972602739,
    0.07869186957349389, 1, -0.014065910937871918, 0.00019784985051214487, 0.9260273972602739, -0.013025418895892352, 1,
    -0.06025900663388645, 0.003631147880502771, 0.9260273972602739, -0.05580149107466745, 1, -0.10448583202692156,
    0.010917289094358068, 0.9260273972602739, -0.09675674308246435, 1, -0.14690696878997966, 0.02158165747906006,
    0.9260273972602739, -0.13603987794798117, 1, 0.27040580350696203, 0.07311929857024575, 0.0027397260273972603,
    0.0007408378178272932, 1, 0.04160099482625744, 0.0017306427705342982, 0.0027397260273972603, 0.00011397532829111628,
    1, -0.18449600105499397, 0.034038774405284335, 0.0027397260273972603, -0.0005054684960410794, 1,
    -0.40794852697915013, 0.1664220006644584, 0.0027397260273972603, -0.001117667197203151, 1, -0.8471626559576813,
    0.7176845656492726, 0.0027397260273972603, -0.00232099357796625, 1, -1.0630403559683428, 1.130054798417301,
    0.0027397260273972603, -0.0029124393314201172, 1, -1.2765059641666296, 1.6294674765529769, 0.0027397260273972603,
    -0.0034972766141551496, 1, -1.6964123874346084, 2.877814988241588, 0.0027397260273972603, -0.004647705171053722, 1,
    -1.9029546495978793, 3.6212363984261877, 0.0027397260273972603, -0.005213574382459943, 1, -2.107287861267329,
    4.440662130244633, 0.0027397260273972603, -0.005773391400732408, 1, -2.309458776157316, 5.333599838770048,
    0.0027397260273972603, -0.006327284318239222, 1, -2.5095126792245894, 6.297653887188977, 0.0027397260273972603,
    -0.00687537720335504, 1, -2.7074934475522063, 7.330520768538132, 0.0027397260273972603, -0.007417790267266319, 1,
    -2.903443608111048, 8.429984785480901, 0.0027397260273972603, -0.00795464002222205, 1, -3.097404392589105,
    9.59391397123028, 0.0027397260273972603, -0.008486039431750973, 1, 0.41952527875011303, 0.17600145951036003,
    0.10136986301369863, 0.04252722003768269, 1, 0.33576462845693267, 0.11273788572282203, 0.10136986301369863,
    0.03403641439152468, 1, 0.2541798273968678, 0.0646073846555015, 0.10136986301369863, 0.025766174284066048, 1,
    0.17466068786630165, 0.03050635588592965, 0.10136986301369863, 0.017705330002885374, 1, 0.09710518593792059,
    0.00942941713603813, 0.10136986301369863, 0.009843539396446744, 1, 0.021418674390421322, 0.0004587596126428902,
    0.10136986301369863, 0.0021712080888920244, 1, -0.05248681173799517, 0.0027548654064197477, 0.10136986301369863,
    -0.00532058091590636, 1, -0.12469316975227046, 0.015548386582868537, 0.10136986301369863, -0.012640129536531526, 1,
    -0.19527677482815317, 0.038133018787285235, 0.10136986301369863, -0.01979517991408676, 1, -0.2643089655764237,
    0.06985922928407913, 0.10136986301369863, -0.026792963633774456, 1, -0.3318564773831318, 0.11012872158114106,
    0.10136986301369863, -0.03364024565253665, 1, -0.3979818301243871, 0.15838953710915651, 0.10136986301369863,
    -0.040343363601650195, 1, -0.4627436759015797, 0.21413170958690625, 0.10136986301369863, -0.046908263036598494, 1,
    -0.5261971116442744, 0.27688340030277697, 0.10136986301369863, -0.05334052912558398, 1, -0.5883939607559286,
    0.3462074530540493, 0.10136986301369863, -0.059645415199916056, 1, 0.596265032156989, 0.35553198857317514,
    0.1780821917808219, 0.10618418380877886, 1, 0.5255230541700365, 0.2761744804642032, 0.1780821917808219,
    0.0935862973179517, 1, 0.45683185976156815, 0.20869534809321308, 0.1780821917808219, 0.08135361886164912, 1,
    0.3900758882267138, 0.15215919857585972, 0.1780821917808219, 0.0694655691362641, 1, 0.3251490794820559,
    0.10572192388802831, 0.1780821917808219, 0.05790326072968118, 1, 0.2619538603482723, 0.06861982495136214,
    0.1780821917808219, 0.04664931759626766, 1, 0.20040026253198728, 0.04016026522288942, 0.1780821917808219,
    0.035687717985148415, 1, 0.14040515229377099, 0.019713606790637023, 0.1780821917808219, 0.025003657257794833, 1,
    0.0818915552498183, 0.006706226821234043, 0.1780821917808219, 0.014583427647227915, 1, 0.024788062548003986,
    0.0006144480448837578, 0.1780821917808219, 0.004414312508548655, 1, -0.03097169307383516, 0.0009592457718598487,
    0.1780821917808219, -0.0055155069857514664, 1, -0.08544950098951769, 0.007301617219357584, 0.1780821917808219,
    -0.01521703442279082, 1, -0.13870298427086708, 0.019238517845644402, 0.1780821917808219, -0.024700531445496877, 1,
    -0.1907859660332148, 0.03639928483522699, 0.1780821917808219, -0.033975582992216334, 1, -0.24174879637927182,
    0.05844248055082663, 0.1780821917808219, -0.04305115551959635, 1, -0.2916386449197931, 0.08505309921065315,
    0.1780821917808219, -0.05193564909530561, 1, -0.34049976313070546, 0.11594008869206653, 0.1780821917808219,
    -0.06063694411916672, 1, -0.3883737202038098, 0.15083414654494712, 0.1780821917808219, -0.06916244332396612, 1,
    -0.4352996155411084, 0.18948575529023678, 0.1780821917808219, -0.0775191096169097, 1, -0.48131427061451953,
    0.23166342709718693, 0.1780821917808219, -0.08571350024642128, 1, -0.5264524025497558, 0.2771521321504101,
    0.1780821917808219, -0.09375179771434007, 1, -0.5707467814844313, 0.3257518885748371, 0.1780821917808219,
    -0.10163983779859734, 1, -0.6142283734870986, 0.3772764947966067, 0.1780821917808219, -0.1093831350045518, 1,
    -0.6569264705985027, 0.4315523877730055, 0.1780821917808219, -0.11698690572302103, 1, 0.3474174180559851,
    0.12069886236868711, 0.4273972602739726, 0.14848525264858542, 1, 0.25998664839107144, 0.0675930573416226,
    0.4273972602739726, 0.11111758123015657, 1, 0.1772842350151502, 0.03142969998490701, 0.4273972602739726,
    0.07577079633524228, 1, 0.09882488134046545, 0.009766357171957077, 0.4273972602739726, 0.042237483531815376, 1,
    -0.11495806627490571, 0.013215357001665613, 0.4273972602739726, -0.04913276257228847, 1, -0.18005819056625938,
    0.03242095198999538, 0.4273972602739726, -0.07695637733790812, 1, -0.24250041316111223, 0.05880645038331014,
    0.4273972602739726, -0.10364401220036579, 1, -0.30249328048245067, 0.09150218473703457, 0.4273972602739726,
    -0.12928479932948578, 1, -0.3602217180172309, 0.1297596861312854, 0.4273972602739726, -0.153957775371748, 1,
    -0.4158504681372528, 0.1729316118499723, 0.4273972602739726, -0.17773335076551078, 1, 0.4385849995750308,
    0.19235680185222975, 0.6767123287671233, 0.29679587642474686, 1, 0.2169512080281383, 0.04706782666486854,
    0.6767123287671233, 0.1468135572135621, 1, 0.15122599451387245, 0.02286930141670978, 0.6767123287671233,
    0.10233649491760684, 1, 0.08887282291995423, 0.00789837865376154, 0.6767123287671233, 0.06014133496227039, 1,
    0.029562507314832644, 0.0008739418387395336, 0.6767123287671233, 0.020005313169215517, 1, -0.026988169573221917,
    0.0007283612969129812, 0.6767123287671233, -0.018263227081057022, 1, -0.08102463598322594, 0.006564991636214272,
    0.6767123287671233, -0.05483037010371728, 1, -0.13276096862693823, 0.017625474790762877, 0.6767123287671233,
    -0.08984098424891436, 1, -0.18238501519130268, 0.03326429376633171, 0.6767123287671233, -0.1234221883623336, 1,
    0.25386327860172475, 0.06444656422241692, 0.9260273972602739, 0.23508435114351497, 1, 0.19446576706022412,
    0.037816934558321344, 0.9260273972602739, 0.18008062812700204, 1, 0.13828054105989113, 0.019121508035816234,
    0.9260273972602739, 0.12805156952943342, 1, 0.0849779064920866, 0.007221244591777814, 0.9260273972602739,
    0.07869186957349389, 1, 0.034276458626853974, 0.0011748756159984323, 0.9260273972602739, 0.03174093976952505, 1,
    -0.014065910937871918, 0.00019784985051214487, 0.9260273972602739, -0.013025418895892352, 1, -0.06025900663388645,
    0.003631147880502771, 0.9260273972602739, -0.05580149107466745, 1, -0.10448583202692156, 0.010917289094358068,
    0.9260273972602739, -0.09675674308246435, 1, -0.14690696878997966, 0.02158165747906006, 0.9260273972602739,
    -0.13603987794798117, 1, 2.9866455977635638, 8.920051926640475, 0.0027397260273972603, 0.008182590678804284, 1,
    2.7231245484374598, 7.415407306302719, 0.0027397260273972603, 0.00746061520119852, 1, 2.4631889308896486,
    6.0672997092572905, 0.0027397260273972603, 0.0067484628243552015, 1, 2.2067424875227557, 4.869712406238119,
    0.0027397260273972603, 0.0060458698288294675, 1, 1.9536927857728772, 3.8169155011809854, 0.0027397260273972603,
    0.0053525829747202115, 1, 1.703951018093167, 2.90344907206074, 0.0027397260273972603, 0.004668358953679909, 1,
    1.4574318148428778, 2.1241074949162044, 0.0027397260273972603, 0.0039929638762818565, 1, 1.2140530690952729,
    1.4739248545796515, 0.0027397260273972603, 0.0033261727920418436, 1, 0.9737357724647941, 0.9481613545776093,
    0.0027397260273972603, 0.002667769239629573, 1, 0.7364038611321385, 0.5422906466903219, 0.0027397260273972603,
    0.0020175448250195575, 1, 0.5019840713163721, 0.2519880078553606, 0.0027397260273972603, 0.0013752988255243072, 1,
    0.27040580350696203, 0.07311929857024575, 0.0027397260273972603, 0.0007408378178272932, 1, 0.04160099482625744,
    0.0017306427705342982, 0.0027397260273972603, 0.00011397532829111628, 1, -0.18449600105499397, 0.034038774405284335,
    0.0027397260273972603, -0.0005054684960410794, 1, -0.40794852697915013, 0.1664220006644584, 0.0027397260273972603,
    -0.001117667197203151, 1, -0.6288177288273601, 0.3954117360875994, 0.0027397260273972603, -0.001722788298157151, 1,
    -0.8471626559576813, 0.7176845656492726, 0.0027397260273972603, -0.00232099357796625, 1, -1.0630403559683428,
    1.130054798417301, 0.0027397260273972603, -0.0029124393314201172, 1, -1.2765059641666296, 1.6294674765529769,
    0.0027397260273972603, -0.0034972766141551496, 1, -1.4876127880944259, 2.212991807302071, 0.0027397260273972603,
    -0.004075651474231304, 1, -1.6964123874346084, 2.877814988241588, 0.0027397260273972603, -0.004647705171053722, 1,
    -1.9029546495978793, 3.6212363984261877, 0.0027397260273972603, -0.005213574382459943, 1, -2.107287861267329,
    4.440662130244633, 0.0027397260273972603, -0.005773391400732408, 1, -2.309458776157316, 5.333599838770048,
    0.0027397260273972603, -0.006327284318239222, 1, -2.5095126792245894, 6.297653887188977, 0.0027397260273972603,
    -0.00687537720335504, 1, -2.7074934475522063, 7.330520768538132, 0.0027397260273972603, -0.007417790267266319, 1,
    -2.903443608111048, 8.429984785480901, 0.0027397260273972603, -0.00795464002222205, 1, 1.1847028326524807,
    1.4035208016948115, 0.10136986301369863, 0.1200931638579227, 1, 1.078223542673111, 1.1625660079745541,
    0.10136986301369863, 0.1092993728189181, 1, 0.9752360131894412, 0.951085281421636, 0.10136986301369863,
    0.09885954106303925, 1, 0.8755184873768772, 0.7665326217386951, 0.10136986301369863, 0.08875118913135467, 1,
    0.7788696850545391, 0.606637986296957, 0.10136986301369863, 0.07895391327950123, 1, 0.59406119238111,
    0.35290870029326615, 0.10136986301369863, 0.060219901693427585, 1, 0.5055810246824227, 0.25561217251892854,
    0.10136986301369863, 0.051250679214382575, 1, 0.41952527875011303, 0.17600145951036003, 0.10136986301369863,
    0.04252722003768269, 1, 0.33576462845693267, 0.11273788572282203, 0.10136986301369863, 0.03403641439152468, 1,
    0.09710518593792059, 0.00942941713603813, 0.10136986301369863, 0.009843539396446744, 1, 0.021418674390421322,
    0.0004587596126428902, 0.10136986301369863, 0.0021712080888920244, 1, -0.05248681173799517, 0.0027548654064197477,
    0.10136986301369863, -0.00532058091590636, 1, -0.12469316975227046, 0.015548386582868537, 0.10136986301369863,
    -0.012640129536531526, 1, -0.19527677482815317, 0.038133018787285235, 0.10136986301369863, -0.01979517991408676, 1,
    -0.2643089655764237, 0.06985922928407913, 0.10136986301369863, -0.026792963633774456, 1, -0.3979818301243871,
    0.15838953710915651, 0.10136986301369863, -0.040343363601650195, 1, -0.4627436759015797, 0.21413170958690625,
    0.10136986301369863, -0.046908263036598494, 1, -0.5883939607559286, 0.3462074530540493, 0.10136986301369863,
    -0.059645415199916056, 1, 0.8221196854402781, 0.6758807771884219, 0.1780821917808219, 0.1464048754893646, 1,
    0.744418289009054, 0.5541585890111675, 0.1780821917808219, 0.13256764050846168, 1, 0.20040026253198728,
    0.04016026522288942, 0.1780821917808219, 0.035687717985148415, 1, 0.14040515229377099, 0.019713606790637023,
    0.1780821917808219, 0.025003657257794833, 1, 0.0818915552498183, 0.006706226821234043, 0.1780821917808219,
    0.014583427647227915, 1, 0.024788062548003986, 0.0006144480448837578, 0.1780821917808219, 0.004414312508548655, 1,
    -0.03097169307383516, 0.0009592457718598487, 0.1780821917808219, -0.0055155069857514664, 1, -0.13870298427086708,
    0.019238517845644402, 0.1780821917808219, -0.024700531445496877, 1, -0.1907859660332148, 0.03639928483522699,
    0.1780821917808219, -0.033975582992216334, 1, -0.24174879637927182, 0.05844248055082663, 0.1780821917808219,
    -0.04305115551959635, 1, -0.2916386449197931, 0.08505309921065315, 0.1780821917808219, -0.05193564909530561, 1,
    -0.3883737202038098, 0.15083414654494712, 0.1780821917808219, -0.06916244332396612, 1, -0.4352996155411084,
    0.18948575529023678, 0.1780821917808219, -0.0775191096169097, 1, -0.48131427061451953, 0.23166342709718693,
    0.1780821917808219, -0.08571350024642128, 1, -0.5264524025497558, 0.2771521321504101, 0.1780821917808219,
    -0.09375179771434007, 1, 0.44015017584204286, 0.19373217729378125, 0.4273972602739726, 0.1881189792639964, 1,
    0.3474174180559851, 0.12069886236868711, 0.4273972602739726, 0.14848525264858542, 1, 0.25998664839107144,
    0.0675930573416226, 0.4273972602739726, 0.11111758123015657, 1, 0.1772842350151502, 0.03142969998490701,
    0.4273972602739726, 0.07577079633524228, 1, 0.09882488134046545, 0.009766357171957077, 0.4273972602739726,
    0.042237483531815376, 1, 0.024194370820078148, 0.000585367579379449, 0.4273972602739726, 0.010340607802553949, 1,
    -0.04696367046447257, 0.0022055863434955734, 0.4273972602739726, -0.020072144088925263, 1, -0.24250041316111223,
    0.05880645038331014, 0.4273972602739726, -0.10364401220036579, 1, -0.30249328048245067, 0.09150218473703457,
    0.4273972602739726, -0.12928479932948578, 1, -0.3602217180172309, 0.1297596861312854, 0.4273972602739726,
    -0.153957775371748, 1, 0.2864341380827057, 0.08204451545918251, 0.6767123287671233, 0.1938335126203515, 1,
    0.2169512080281383, 0.04706782666486854, 0.6767123287671233, 0.1468135572135621, 1, 0.15122599451387245,
    0.02286930141670978, 0.6767123287671233, 0.10233649491760684, 1, 0.08887282291995423, 0.00789837865376154,
    0.6767123287671233, 0.06014133496227039, 1, -0.08102463598322594, 0.006564991636214272, 0.6767123287671233,
    -0.05483037010371728, 1, -0.13276096862693823, 0.017625474790762877, 0.6767123287671233, -0.08984098424891436, 1,
    -0.18238501519130268, 0.03326429376633171, 0.6767123287671233, -0.1234221883623336, 1, -0.23006251156743637,
    0.052928759228716794, 0.6767123287671233, -0.1556861379648131, 1, -0.2759404216300111, 0.07614311628934829,
    0.6767123287671233, -0.1867322853222267, 1, -0.3201496693402439, 0.10249581077866751, 0.6767123287671233,
    -0.21664922829326094
  };

  size_t X_cols = 5;
  size_t X_rows = LENGTH(X_data) / X_cols;
  assert((LENGTH(X_data) % X_cols) == 0);
  gsl_matrix_view X = gsl_matrix_view_array(X_data, X_rows, X_cols);

  double Y_data[] = {
    0.3148252657784765, 0.30058344929044784, 0.2870055771490522, 0.27433344508944285, 0.2332745466642172,
    0.2250560513335572, 0.21984440686023948, 0.2173810886472627, 0.38334998704092715, 0.3213108713696361,
    0.30449694425341894, 0.3214862435772447, 0.4451922118118028, 0.4932843559122604, 0.5606114471959378,
    0.6645091031763971, 0.762856609407932, 0.829198015799967, 0.9047472891114372, 0.973619385044027, 1.0412323996820227,
    1.1009728672956778, 1.165967231623276, 0.34383823387429463, 0.3281731281119345, 0.31398331833066356,
    0.3016279198677918, 0.2854797314499655, 0.2544432468638052, 0.22830175466575686, 0.22237064057175437,
    0.21738122429563742, 0.21399808350036803, 0.21074403855700144, 0.20746211714141358, 0.2296486030523001,
    0.2553627216368418, 0.2718397502319833, 0.39078259665773524, 0.3788991346385575, 0.3659098669316515,
    0.350850640701867, 0.33270405033734807, 0.3169880221570998, 0.3035334685492442, 0.29114053360666026,
    0.2780447604914001, 0.2543099202829338, 0.2349683023487262, 0.22905089539115991, 0.22402381177751965,
    0.21937663618370926, 0.215060376061286, 0.21353598303271826, 0.20959530379613947, 0.2100597509818782,
    0.2097143839755949, 0.2185067977973405, 0.21696769377713795, 0.26088495091105934, 0.24805463536268416,
    0.25290718885006325, 0.36141973867600524, 0.33929217931733274, 0.31978355175530837, 0.30359130809478757,
    0.21564293892837, 0.21245648217404, 0.20950747190810975, 0.20757240977942484, 0.2019114938910768,
    0.19966388292210155, 0.3747402225688468, 0.31771433015507067, 0.3016156455528424, 0.2874190117270371,
    0.2507376570861439, 0.2277146365972996, 0.2220009119339234, 0.21737834135332737, 0.21368575211468277,
    0.3149443657139698, 0.30071258117876615, 0.2870665085330387, 0.27440995508383503, 0.2517259690750651,
    0.2333189956225871, 0.22512036898247514, 0.2198651558117572, 0.2174264048696261, 1.0633085498651806,
    1.3569844920836662, 1.244003545458652, 1.1331767301674984, 0.8256266489214898, 0.7319496236406396,
    0.6382501756872212, 0.5924645760953218, 0.5300950028327969, 0.4955750692459897, 0.4366511785932462,
    0.38347051992408604, 0.3212456763076742, 0.3045030340443518, 0.32165164793892936, 0.4299864112720107,
    0.4437421998999065, 0.4892514655457836, 0.5592890454887125, 0.6549644507727053, 0.6761009854304728,
    0.7743276046743083, 0.8223668117200197, 0.8936355250454995, 0.9637828826732038, 1.0328803443292298, 1.1009883893741,
    0.5198506745466318, 0.4855772113152414, 0.4442582404342367, 0.4233782811910317, 0.4016970290680565,
    0.36794340395506914, 0.35921164268015227, 0.34403332588232927, 0.3283118285933378, 0.2854142680756619,
    0.2546370842357041, 0.22841253751349136, 0.22248536608071467, 0.2172962804730557, 0.21401362313688924,
    0.20784409817497923, 0.2300438858248836, 0.27220351364763823, 0.4427784117974077, 0.4239514985473345,
    0.30348872914083236, 0.2911198762005487, 0.2780133998241648, 0.254268338658652, 0.2350570610454258,
    0.22410055294065617, 0.21945174796633973, 0.21498368804913687, 0.21354074428555817, 0.21009511293325142,
    0.20945433617238438, 0.21862834953785348, 0.21697194751765975, 0.3863446887267114, 0.3615288971991729,
    0.33944018700677325, 0.31986671112231463, 0.3037282345320045, 0.2570515422739903, 0.21971377344700216,
    0.20969413105489976, 0.20780267796025506, 0.20230744530513345, 0.3352862777249665, 0.317758132357509,
    0.30171062990020836, 0.287475121547231, 0.22204665225587464, 0.21739799702601328, 0.21379099403464896,
    0.21051501631430158, 0.20839403793903094, 0.20514904316357077
  };

  size_t Y_cols = 1;
  size_t Y_rows = LENGTH(X_data) / X_cols;
  assert((LENGTH(Y_data) % Y_cols) == 0);
  gsl_vector_view Y = gsl_vector_view_array(Y_data, Y_rows);

  gsl_matrix *C = gsl_matrix_calloc(X_cols, X_cols);
  gsl_blas_dgemm(CblasTrans, CblasNoTrans, 1.0, &X.matrix, &X.matrix, 0.0, C);

  gsl_permutation *perm = gsl_permutation_alloc(X_cols);

  int signum;
  gsl_linalg_LU_decomp(C, perm, &signum);
  gsl_matrix *D = gsl_matrix_calloc(X_cols, X_cols);
  gsl_linalg_LU_invert(C, perm, D);

  gsl_matrix *E = gsl_matrix_calloc(X_cols, Y_rows);
  gsl_blas_dgemm(CblasNoTrans, CblasTrans, 1.0, D, &X.matrix, 0.0, E);

  gsl_vector* B = gsl_vector_calloc(X_cols);
  gsl_blas_dgemv(CblasNoTrans, 1.0, E, &Y.vector, 0.0, B);

  printf("\nB = \n");
  gsl_vector_fprintf(stdout, B, "%.20f");

  gsl_permutation_free(perm);
  gsl_matrix_free(C);
  gsl_matrix_free(D);
  gsl_matrix_free(E);
  gsl_vector_free(B);

  printf("\n\U0001f602 \n");

  return 0;
}
